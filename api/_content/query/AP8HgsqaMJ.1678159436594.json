{"_path":"/guide/storage","_dir":"guide","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Client Storage","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"client-storage"},"children":[{"type":"text","value":"Client Storage"}]},{"type":"element","tag":"h3","props":{"id":"what-it-is"},"children":[{"type":"text","value":"What it is"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The shieldbow client has a built-in storage system."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Storage systems are intended to store data on disks to avoid fetching the same data multiple times."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The shieldbow storage serves two primary purposes."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"To relieve the API servers from unnecessary requests."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"To avoid caching too much data as memory is a lot more limited than disk space."}]}]},{"type":"element","tag":"alert","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"NOTE"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nShieldbow sends raw JSON objects to the storage, not the processed JS objects."}]}]},{"type":"element","tag":"h3","props":{"id":"how-does-it-work"},"children":[{"type":"text","value":"How does it work"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, shieldbow provides a built-in storage that stores the data using JSON files.\nSome helpful links to learn more about this storage system:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"API docs: "},{"type":"element","tag":"a","props":{"href":"/api/localstorage"},"children":[{"type":"text","value":"LocalStorage"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Source code: "},{"type":"element","tag":"a","props":{"href":"https://github.com/TheDrone7/shieldbow/blob/update/v2/src/util/LocalStorage.ts","rel":["nofollow"]},"children":[{"type":"text","value":"GitHub"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Whenever you make a request to one of the APIs, the client will"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Check "},{"type":"element","tag":"a","props":{"href":"/guide/caching#how-does-it-work"},"children":[{"type":"text","value":"caching"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Check if storage is enabled."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Check if the data is already stored."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If it is, it will return the stored data."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If not, it will proceed to fetching the data from the APIs."}]}]},{"type":"element","tag":"h3","props":{"id":"the-defaults"},"children":[{"type":"text","value":"The defaults"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, the client will store all data dragon files, but not the data fetched from RIOT APIs."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This can be changed by setting the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"storage"}]},{"type":"text","value":" option to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"false"}]},{"type":"text","value":" when initializing the client.\nYou can set it to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":" to enable storage, or to an object to customize the storage.\nThe object can be fine-tuned to a per-API basis."}]},{"type":"element","tag":"code","props":{"code":"client.initialize({\n  storage: {\n    enable: {\n      api: { // API caching\n        summoner: true, // Enable or disable caching for the summoner API\n        match: true, // Enable or disable caching for the match API\n        // ... so on\n      },\n      dragon: {\n        champions: true, // Enable or disable caching for the champions data dragon\n        items: true, // Enable or disable caching for the items data dragon\n        // ... so on\n      }\n    } // Enable or disable caching\n  }\n})\n","language":"ts","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"client."}]},{"type":"element","tag":"span","props":{"class":"ct-f72bf2"},"children":[{"type":"text","value":"initialize"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"({"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"  storage: {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"    enable: {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"      api: { "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// API caching"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        summoner: "}]},{"type":"element","tag":"span","props":{"class":"ct-f3a16c"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// Enable or disable caching for the summoner API"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        match: "}]},{"type":"element","tag":"span","props":{"class":"ct-f3a16c"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// Enable or disable caching for the match API"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// ... so on"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"      },"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"      dragon: {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        champions: "}]},{"type":"element","tag":"span","props":{"class":"ct-f3a16c"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// Enable or disable caching for the champions data dragon"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        items: "}]},{"type":"element","tag":"span","props":{"class":"ct-f3a16c"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// Enable or disable caching for the items data dragon"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// ... so on"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"      }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"    } "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// Enable or disable caching"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"  }"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"})"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For quicker access, you can simply set "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"api"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dragon"}]},{"type":"text","value":" to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"false"}]},{"type":"text","value":" to\nenable or disable storage for all APIs or data dragon data respectively."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Defaults to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"{ dragon: true, api: false }"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This can be used at any level in the object."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"custom-cache"},"children":[{"type":"text","value":"Custom cache"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As you can see, the default storage is a simple a JSON files storage medium.\nThis is not ideal for production environments."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To solve this, you can provide your own storage system by implementing the "},{"type":"element","tag":"a","props":{"href":"/api/istorage"},"children":[{"type":"text","value":"IStorage"}]},{"type":"text","value":" interface."}]},{"type":"element","tag":"code","props":{"code":"import { IStorage } from 'shieldbow'\n\nclass MyStorage implements ICache {\n  // ...\n}\n","language":"ts","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3fc03d"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" { IStorage } "}]},{"type":"element","tag":"span","props":{"class":"ct-3fc03d"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"'shieldbow'"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3fc03d"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-c9cc4c"},"children":[{"type":"text","value":"MyStorage"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3fc03d"},"children":[{"type":"text","value":"implements"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-f3a16c"},"children":[{"type":"text","value":"ICache"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-38d312"},"children":[{"type":"text","value":"// ..."}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"h5","props":{"id":"the-keys"},"children":[{"type":"text","value":"The keys"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As you can see, the storage interface has a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"get"}]},{"type":"text","value":" and a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"set"}]},{"type":"text","value":" method that take "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"key"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" and "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"value"}]},{"type":"text","value":" as parameters."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"key"}]},{"type":"text","value":" is a unique identifier for the type and version of the object.\nThe "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" is the id of the data that is being fetched.\nThe "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"value"}]},{"type":"text","value":" is the data that is stored in the cache."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The keys are generated using the following format can contain many values separated by a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":":"}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"code":"`${managerName}:${version}?:${source}?:${locale}?`\n","language":"ts","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"`${"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"managerName"}]},{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"}:${"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"version"}]},{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"}?:${"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"source"}]},{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"}?:${"}]},{"type":"element","tag":"span","props":{"class":"ct-c57963"},"children":[{"type":"text","value":"locale"}]},{"type":"element","tag":"span","props":{"class":"ct-fd3796"},"children":[{"type":"text","value":"}?`"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"is the format for champion data."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Where "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"managerName"}]},{"type":"text","value":" is the name of the manager that is fetching the data, version is the patch version, source is the\nsource of the data (e.g. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"riot"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ddragon"}]},{"type":"text","value":") and locale is the locale of the data.\nSome common examples for "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"managerName"}]},{"type":"text","value":" are "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"summoner"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"match"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"champion"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"item"}]},{"type":"text","value":", etc."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" is the id of the data that is being fetched.\nFor example, if you are fetching the data for the champion "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Aatrox"}]},{"type":"text","value":", the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" will be "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Aatrox"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The values are always a JSON object based on one of the shieldbow interfaces (e.g. a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"SummonerData"}]},{"type":"text","value":" object)."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"caveats"},"children":[{"type":"text","value":"Caveats"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The storage system can use up a LOT of disk space."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To solve, this you can make a custom storage system that only saves the data you need,\nthis however would lead to another problem as the storage system cannot fetch data from\nstorage if the entire object is not stored."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In these cases, in your custom storage, you can simply return a "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Promise.reject"}]},{"type":"text","value":" to indicate that the data is not\nstored,\nand the client will fetch the data from the APIs as a workaround."}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-c9cc4c{color:#953800}\n.ct-fd3796{color:#0A3069}\n.ct-3fc03d{color:#CF222E}\n.ct-f3a16c{color:#0550AE}\n.ct-38d312{color:#6E7781}\n.ct-f72bf2{color:#8250DF}\n.ct-c57963{color:#24292F}\n.dark .ct-c57963{color:#C9D1D9}\n.dark .ct-f72bf2{color:#D2A8FF}\n.dark .ct-38d312{color:#8B949E}\n.dark .ct-f3a16c{color:#79C0FF}\n.dark .ct-3fc03d{color:#FF7B72}\n.dark .ct-fd3796{color:#A5D6FF}\n.dark .ct-c9cc4c{color:#FFA657}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"what-it-is","depth":3,"text":"What it is"},{"id":"how-does-it-work","depth":3,"text":"How does it work"},{"id":"the-defaults","depth":3,"text":"The defaults"},{"id":"custom-cache","depth":3,"text":"Custom cache"},{"id":"caveats","depth":3,"text":"Caveats"}]}},"_type":"markdown","_id":"content:0.guide:5.storage.md","_source":"content","_file":"0.guide/5.storage.md","_extension":"md"}